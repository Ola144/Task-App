<div class="m-6">
    <div class="flex justify-between items-center mb-5 mx-10 stick">
        <h2 class="text-2xl text-dark-800 font-bold">Projects</h2>
        <div class="gap-2">
            <button class="rounded-md p-2 bg-yellow-500 text-white  transition ease-in 0.5s hover:bg-yellow-600 mr-2"
                (click)="isProjectForm = true">
                <i class="fa fa-plus-circle text-lg"> Add Project</i></button>
        </div>
    </div>
    <hr class="bg-yellow-200 h-1">
    <div class="py-5 px-10 mt-5 mb-10 mx-auto">
        <div class="grid gap-2 lg:grid-cols-3 xl:grid-cols-3 md:grid-cols-2 sm:grid-cols-1 task">
            @for(item of projectList; track $index){
            <div class="border-t-8 border-yellow-400 rounded-md bg-white p-2 shadow-xl">
                <div class="mt-3 mb-5">
                    <p class="font-bold text-dark-500 mb-5">Project Name: <span
                            class="text-gray-700">{{item.projectName}}</span>
                    </p>
                    <p class="font-bold text-dark-500 mb-5">Short Name: <span
                            class="text-gray-700">{{item.shortName}}</span></p>
                    <p class="font-bold text-dark-500 mb-5">Created Date: <span
                            class="text-gray-700">{{item.createdDate | date:'dd-MMM-yyyy'}}</span></p>
                </div>
                <div class="flex justify-end">
                    <button class="bg-gray-600 p-2 rounded-md mx-1 hover:bg-gray-900" (click)="onEdit(item)">
                        <i class="fa fa-edit text-green-500"></i>
                    </button>
                    <button class="bg-gray-600 p-2 rounded-md mx-1 hover:bg-gray-900">
                        <i class="fa fa-trash text-red-500" (click)="onDelete()"></i>
                    </button>
                </div>
            </div>
            }

        </div>
    </div>
</div>



<!-- Add New Project Section -->
@if (isProjectForm) {
<div class="bg-gray-800/50 absolute top-0 left-0 flex justify-center items-center z-20 min-h-screen w-screen">
    <div class="bg-white w-96 rounded-lg shadow-lg px-8 py-4 my-2">
        <div class="flex justify-between w-full">
            <h3 class="text-black font-bold text-xl">New Project</h3>
            <button class="bg-black text-white p-2 rounded-xl" (click)="closeProjectForm()">
                <i class="fa fa-times text-lg"></i>
            </button>
        </div>
        <div class="mt-10 mb-4">
            <form #projectForm="ngForm">
                <div class="my-2">
                    <label for="projectName" class="text-black text-lg font-bold">Project Name</label>
                    <input id="projectName" type="text" class="w-full p-1 border-2 border-yellow-400 rounded-md"
                        placeholder="Project Name" name="projectName" required [(ngModel)]="projectObj.projectName"
                        #projectName="ngModel" [class]="projectName.invalid && projectName.touched ?'is-invalid':''">
                    @if (projectName.invalid && projectName.touched) {
                    <div class="text-red-600 test-sm">
                        @if (projectName.errors?.['required']) {
                        <span>*Project name is a required field!</span>
                        }
                    </div>
                    }
                </div>
                <div class="my-2">
                    <label for="shortName" class="text-black text-lg font-bold">Short Name</label>
                    <input id="shortName" type="text" class="w-full p-1 border-2 border-yellow-400 rounded-md"
                        placeholder="Short Name" required name="shortName" [(ngModel)]="projectObj.shortName"
                        #shortName="ngModel" [class]="shortName.invalid && shortName.touched ?'is-invalid':''">
                    @if (shortName.invalid && shortName.touched) {
                    <div class="text-red-600 test-sm">
                        @if (shortName.errors?.['required']) {
                        <span>*Short name is a required field!</span>
                        }
                    </div>
                    }
                </div>
                @if (projectObj.projectId == 0) {
                <button
                    class="text-center w-full bg-yellow-400 hover:bg-yellow-600 text-white font-bold text-lg py-3 my-3 rounded-lg flex justify-center items-center"
                    [class]="projectForm.invalid || isAddProjectLoading ? 'bg-yellow-100 hover:bg-yellow-100 cursor-not-allowed' :''"
                    [disabled]="projectForm.invalid || isAddProjectLoading" (click)="createNewProject()">
                    @if (isAddProjectLoading) {
                    <img src="/public/images/spinner.gif" style="width: 24px; margin-right: 4px;" alt="">
                    }
                    Add
                    Project</button>
                } @else {
                <button
                    class="text-center w-full bg-yellow-400 hover:bg-yellow-600 text-white font-bold text-lg py-3 my-3 rounded-lg flex justify-center items-center"
                    [class]="projectForm.invalid || isUpdateProjectLoading ? 'bg-yellow-100 hover:bg-yellow-100 cursor-not-allowed' :''"
                    [disabled]="projectForm.invalid || isUpdateProjectLoading" (click)="updateProject()">
                    @if (isUpdateProjectLoading) {
                    <img src="/public/images/spinner.gif" style="width: 24px; margin-right: 4px;" alt="">
                    }
                    Update
                    Project</button>
                }
            </form>
        </div>
    </div>
</div>
}

@if (isConfirmDelete) {
<div class="w-screen min-h-screen bg-gray-800/50  absolute top-0 left-0 flex justify-center items-center z-20">
    <div class="bg-white w-96 px-10 py-10 rounded-lg shadow-lg">
        <p class="text-center my-4 text-md text-black">Are you sure want to delete the project?</p>
        <div class="flex justify-end items-center my-2">
            <button class="p-1 mr-3 bg-gray-500 text-white rounded-md" (click)="isConfirmDelete = false"
                [disabled]="isDeleteProjectLoading"
                [class]="isDeleteProjectLoading ? 'bg-gray-100 cursor-not-allowed' : ''">Cancel</button>
            <button class="p-1 mr-3 bg-red-500 text-white flex justify-center items-center rounded-md"
                [class]="isDeleteProjectLoading ? 'bg-red-100 cursor-not-allowed' : ''" (click)="deleteProjectById()"
                [disabled]="isDeleteProjectLoading">
                @if (isDeleteProjectLoading) {
                <img src="/public/images/spinner.gif" style="width: 24px; margin-right: 4px;">
                }
                Delete</button>
        </div>
    </div>
</div>
}